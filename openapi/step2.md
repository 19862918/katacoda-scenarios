### Изменение функции
Попробуем внести изменения в нашу функцию.  
Для этого откроем в редакторе файл fn1/handler.py и изменим текст, который выдается в ответ на запрос

<pre class="file" data-filename="./fn1/handler.py" data-target="insert" data-marker="Hello from OpenFaaS!">
changed</pre>

Для публикации изменений пересоберем и опубликуем образ
`faas-cli up -f fn1.yml `{{execute}}

Кубернетес развернет новый под с функцией и уничтожит предыдущую версию. Посмотреть статус деплоймента можно командой:
`kubectl get po -n openfaas-fn`{{execute}}

Также статус функции можно отследить через faas-cli:
`faas-cli list -v`{{execute}}

Проверим, что измененная функция успешно установлена в кластер командой:
`curl $OPENFAAS_URL/function/fn1`{{execute}}  
Функция должна вывести наш измененный текст:  
`changed`
### Настройки автоскейлинга
По-умолчанию openfaas устанавливает настройки автоскейлинга следующим образом:
- минимум 1 реплика, максимум 20
- скейл на 20% от максималного значания,( т.е. + 4 реплики), при среденей нагрузке на функцию >5 запросов за последние 5 сек.

Изменим для нашей функции данные настройки на следующие:
- минимум 2 реплики, максимум 10
- скейл на 50% от максимального значения ( + 5 реплик )
<pre class="file" data-filename="./fn1.yml" data-target="append">
    labels:
      com.openfaas.scale.min: "2"
      com.openfaas.scale.max: "10"
      com.openfaas.scale.factor: "50"
</pre>

И далее заново опубликуем изменения:
`faas-cli up -f fn1.yml`{{execute}}

Убедимся, что кубернетес развернет новый под с количеством реплик равным двум:
`kubectl get po -n openfaas-fn`{{execute}}

После того, как статус подов перейдет в Ready, попробуем сгенерировать нагрузку на функцию и посмотреть как отработает автоскейлинг.  
Сделаем это с помощью скрипта:
`for i in {1..5000}; do curl -s $OPENFAAS_URL/function/fn1 > /dev/null;[[ $((i % 1000)) = 0 ]] && echo "$i times executed";done && faas-cli list -v`{{execute}}  
Скрипт вызовет функцию 5000 раз без вывода результата работы функции на печать, после чего покажет ее текущий статус.  
Видно, что количество реплик возрасло и автоскейлинг отрабатывает.  
Если продолжить генерировать нагрузку  - следующее увеличение произойдет через ~40сек.  
При прекращении потока запросов к функции количество реплик будет возвращено к минимальному.  

На этом обзор serverless функций завершен. Далее перейдем к изучению функциональности api gateway.