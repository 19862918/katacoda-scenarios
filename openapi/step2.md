### Изменение функции
Попробуем внести изменения в нашу функцию.  
Для этого откроем в редакторе файл fn1/handler.py и изменим текст, который выдается в ответ на запрос

<pre class="file" data-filename="./fn1/handler.py" data-target="insert" data-marker="Hello from OpenFaaS!">
changed</pre>

Для публикации изменений пересоберем и опубликуем образ
`faas-cli up -f fn1.yml `{{execute}}

Кубернетес развернет новый под с функцией и уничтожит предыдущую версию. Посмотреть статус деплоймента можно командой:
`kubectl get po -n openfaas-fn`{{execute}}

Также статус функции можно отследить через faas-cli:
`faas-cli list -v`{{execute}}

Проверим, что измененная функция успешно установлена в кластер командой:
`curl $OPENFAAS_URL/function/fn1`{{execute}}  
Функция должна вывести наш измененный текст:  
`changed`
### Настройки автоскейлинга
По-умолчанию openfaas устанавливает настройки автоскейлинга следующим образом:
- минимум 1 реплика, максимум 20
- скейл на 20% от максималного значания,( т.е. + 4 реплики), при среденей нагрузке на функцию >5 запросов за последние 5 сек.

Изменим для нашей функции данные настройки на следующие:
- минимум 2 реплики, максимум 10
- скейл на 50% от максимального значения ( + 5 реплик )
<pre class="file" data-filename="./fn1.yml" data-target="append">
    labels:
      com.openfaas.scale.min: "2"
      com.openfaas.scale.max: "10"
      com.openfaas.scale.factor: "50"
</pre>

И далее заново опубликуем изменения:
`faas-cli up -f fn1.yml`{{execute}}

Убедимся, что кубернетес развернет новый под с количеством реплик равным двум:
`kubectl get po -n openfaas-fn`{{execute}}

После того, как статус подов перейдет в Ready, подадим нагрузку на функцию и посмотрим как отработает автоскейлинг.  
Создаем деплоймент с нагрузкой:
`kubectl create deployment loader --image=httpd:alpine -- sh -c "while true; do ab -n100 $OPENFAAS_URL/function/fn1; done"`{{execute}}  
Понаблюдаем за состоянием функции:
`watch -n1 faas-cli list`{{execute}}  
Заметим, что количество вызовов растет и через некоторое время (~5-10сек) кол-во реплик возрасло. Автоскейлинг отрабатывает согласно настройкам.
Если продолжить генерировать нагрузку  - следующее увеличение произойдет через ~40сек.  
Прервем вывод команды watch `ctrl+c`
Удалим деплоймент нагрузки:
`kubectl delete deployment loader`{{execute}} 
При прекращении потока запросов к функции количество реплик будет возвращено к минимальному.  

На этом обзор serverless функций завершен. Далее перейдем к изучению функциональности api gateway.